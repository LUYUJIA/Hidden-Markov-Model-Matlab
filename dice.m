%************
%author:Luyujia
%************
a0=zeros(1,100);%alpha
a1=zeros(1,100);
b0=zeros(1,100);%beta
b1=zeros(1,100);
data=zeros(1,100);
r1=zeros(1,100); %gamma
%************
%初期化   0は通常　1はイカサマ
%************
data=[4 4 5 4 2 3 3 6 4 5 5 3 4 4 1 4 5 3 6 5 3 3 3 5 5 3 5 6 5 5 1 3 4 3 1 2 6 1 6 1 5 4 2 4 1 5 4 1 1 1 1 5 6 6 6 6 1 6 2 6 2 6 1 6 6 6 6 6 3 2 6 6 6 1 6 6 2 6 6 5 6 6 5 6 6 6 6 4 3 6 6 5 2 5 4 5 6 5 4 4];
a0(1,1)=(1/6)*0.5;
a1(1,1)=(1/10)*0.5;
b0(1,100)=1;
b1(1,100)=1;
 
%************
%繰り返す
%************
for t=2:100     %alpha
    a0(1,t)=(1/6)*(0.9*a0(1,t-1)+0.1*a1(1,t-1));
    if data(1,t)==6
    a1(1,t)=(1/2)*(0.1*a0(1,t-1)+0.9*a1(1,t-1));
    else
    a1(1,t)=(1/10)*(0.1*a0(1,t-1)+0.9*a1(1,t-1));
    end
    
end
 
for t=99:-1:1 %beta
    b0(1,t)=(b0(1,t+1)*(1/6)*0.9+b1(1,t+1)*(1/6)*0.1);
    if data(1,t)==6
    b1(1,t)=(b0(1,t+1)*(1/2)*0.1+b1(1,t+1)*(1/2)*0.9);
    else
    b1(1,t)=(b0(1,t+1)*(1/10)*0.1+b1(1,t+1)*(1/10)*0.9);
    end
end
 
for t=1:100 %gamma
r1(1,t)=a1(1,t)*b1(1,t)/(a0(1,t)*b0(1,t)+a1(1,t)*b1(1,t));
end
 
plot([1:100],r1,'b','linewidth',2);
h1=xlabel('Trial');
h2=ylabel('イカサマ事後確率');
set(h1,'FontSize',16);
set(h2,'FontSize',16);
